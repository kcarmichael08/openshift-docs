// Module included in the following assemblies:
//
// * upgrade/upgrade-roxctl.adoc
:_module-type: PROCEDURE
[id="upgrade-central-kubernetes_{context}"]
= Upgrading Central on Kubernetes

If you installed {product-title} on Kubernetes, use the following procedure to upgrade.

.Prerequisites

* If you deploy images from a private image registry, first push the new image into your private registry, and then replace your image registry in the following commands.

.Procedure

. Patch the local role:
+
[source,terminal]
----
$ kubectl -n stackrox patch role edit -p '{"rules":[{"apiGroups":["*"],"resources":["*"],"verbs":["create","get", "list", "watch", "update", "patch", "delete","deletecollection"]}]}'
----
. Run the following commands to upgrade Central:
+
[source,terminal]
----
$ kubectl -n stackrox patch deploy/central -p '{"spec":{"template":{"spec":{"containers":[{"name":"central","env":[{"name":"ROX_NAMESPACE","valueFrom":{"fieldRef":{"fieldPath":"metadata.namespace"}}}]}]}}}}'
----
+
[source,terminal]
----
$ kubectl -n stackrox patch deployment/scanner -p '{"spec":{"template":{"spec":{"containers":[{"name":"scanner","securityContext":{"runAsUser":65534}}]}}}}'
----
+
[source,terminal,subs=attributes+]
----
$ kubectl -n stackrox set image deploy/central central=registry.redhat.io/advanced-cluster-security/rhacs-main-rhel8:{rhacs-version} <1>
----
<1> If you deploy images from a private image registry, push the new image into your private registry, and replace the image registry address here.

.Verification

* Verify that the new pods have deployed:
+
[source,terminal]
----
$ kubectl get deploy -n stackrox -o wide
----
+
[source,terminal]
----
$ kubectl get pod -n stackrox --watch
----
