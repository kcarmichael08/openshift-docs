// Module included in the following assemblies:
//
// * integration/integrate-with-image-registries.adoc
:_module-type: PROCEDURE
[id="manual-configuration-image-registry-ecr_{context}"]
= Manually configuring Amazon Elastic Container Registry

You can use {product-title} to create and modify ECR integrations
manually. Typically, if you are deploying from ECR, integrations for the ECR
registries should be auto-generated. But you might still want to create
integrations on your own, for example, to scan images outside deployments. It is
also possible to modify the parameters of an auto-generated integration. For
example, you can change the authentication method used by an auto-generated ECR
integration to use AssumeRole authentication or other authorization models.

[IMPORTANT]
====
In case you would like to erase changes you did to an auto-generated ECR
integration, simply delete the integration, and {product-title} will create a
new integration for you with the auto-generated parameters when you deploy
images from ECR.
====

.Prerequisites
* You must have an access key ID and a secret access key. Alternatively, you can use a node-level IAM proxy such as `kiam` or `kube2iam`.
* The access key must have read access to ECR.
See link:https://aws.amazon.com/premiumsupport/knowledge-center/create-access-key/[How do I create an AWS access key?]  for more information.
* If you are running {product-title} in Amazon Elastic Kubernetes Service (EKS) and want to integrate with an ECR from a separate Amazon account, you must first set a repository policy statement in your ECR.
Follow the instructions at link:https://docs.aws.amazon.com/AmazonECR/latest/userguide/set-repository-policy.html[Setting a repository policy statement]  and for *Actions*, choose the following scopes of the Amazon ECR API operations:

** ecr:BatchCheckLayerAvailability
** ecr:BatchGetImage
** ecr:DescribeImages
** ecr:GetDownloadUrlForLayer
** ecr:ListImages

.Procedure
. On the RHACS portal, navigate to *Platform Configuration* -> *Integrations*.
. Under the *Image Integrations* section, select *Amazon Elastic Container Registry*.
+
The *Configure image integration* modal box opens.
. Click *New Integration*, or, click in one of the auto-generated integrations to open it, then click "Edit".
. Enter or modify the details for the following fields:
.. *Integration Name*: The name of the integration.
.. *Types*: Select *Registry*.
.. *Registry ID*: The ID of the registry.
.. *Endpoint (Optional)*: The address of the registry.
.. *Region*: The region for the registry.
.. *Use Container IAM Role*: Turn on the toggle if you are using IAM.
.. *Access Key ID (required if not using IAM)* and *Secret Access Key (required if not using IAM)*: Your access key and secret if you are not using IAM.
. Select *Test* (*`checkmark`* icon) to test that the integration with the selected registry is working.
. Select *Create* (*`save`* icon) to create the configuration.
