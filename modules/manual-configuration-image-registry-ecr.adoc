// Module included in the following assemblies:
//
// * integration/integrate-with-image-registries.adoc
:_module-type: PROCEDURE
[id="manual-configuration-image-registry-ecr_{context}"]
= Manually configuring Amazon Elastic Container Registry

You can use {product-title} to create and modify Amazon ECR integrations
manually. Typically, if you are deploying from Amazon ECR, integrations for the Amazon ECR
registries are autogenerated. However, you may want to create
integrations on your own; for example, to scan images outside deployments. You can also modify the parameters of an autogenerated integration. For example, you can change the authentication method used by an autogenerated Amazon ECR
integration to use AssumeRole authentication or other authorization models.

[IMPORTANT]
====
To to erase changes you made to an autogenerated ECR
integration, delete the integration, and {product-title} will create a
new integration for you with the autogenerated parameters when you deploy
images from Amazon ECR.
====

.Prerequisites
* You must have an access key ID and a secret access key. Alternatively, you can use a node-level IAM proxy such as `kiam` or `kube2iam`.
* The access key must have read access to ECR.
See link:https://aws.amazon.com/premiumsupport/knowledge-center/create-access-key/[How do I create an AWS access key?]  for more information.
* If you are running {product-title} in Amazon Elastic Kubernetes Service (EKS) and want to integrate with an ECR from a separate Amazon account, you must first set a repository policy statement in your ECR.
Follow the instructions at link:https://docs.aws.amazon.com/AmazonECR/latest/userguide/set-repository-policy.html[Setting a repository policy statement]  and for *Actions*, choose the following scopes of the Amazon ECR API operations:

** ecr:BatchCheckLayerAvailability
** ecr:BatchGetImage
** ecr:DescribeImages
** ecr:GetDownloadUrlForLayer
** ecr:ListImages

.Procedure
. On the RHACS portal, navigate to *Platform Configuration* -> *Integrations*.
. Under the *Image Integrations* section, select *Amazon ECR*.
. Click *New Integration*, or click in one of the autogenerated integrations to open it, then click *Edit*.
. Enter or modify the details for the following fields:
.. *Integration Name*: The name of the integration.
.. *Types*: Select *Registry*.
.. *Registry ID*: The ID of the registry.
.. *Endpoint (Optional)*: The address of the registry.
.. *Region*: The region for the registry.
.. *Use Container IAM role*: Check this box if you are using IAM.
.. If you are not using IAM, enter your *Access key ID and *Secret access key* (required if not using IAM)
.. (Optional) To use AssumeRole, check the box. Enter your **AssumeRoleID** and **AssumeRole External ID**.
.. (Optional) To create the integration without testing, check the box.
. Select *Test* to test that the integration with the selected registry is working.
. Select *Save* to save the configuration.
