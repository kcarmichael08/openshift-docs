// Module included in the following assemblies:
//
// * installing/acs-default-requirements.adoc
// * cloud_service/acscs-default-requirements.adoc
:_mod-docs-content-type: CONCEPT
[id="default-requirements-secured-cluster-services_{context}"]
= Secured cluster services

Secured cluster services contain the following components:

* Sensor
* Admission controller
* Collector

[id="default-requirements-secured-cluster-services-sensor_{context}"]
== Sensor

Sensor monitors your Kubernetes and {ocp} clusters. These services currently deploy in a single deployment, which handles interactions with the Kubernetes API and coordinates with Collector.

[discrete]
== Memory and CPU requirements

The following table lists the minimum memory and storage values required to install and run sensor on secured clusters.

[cols="3",options="header"]
|===
| Sensor | CPU | Memory

| *Request*
| 2 cores
| 4 GiB

| *Limit*
| 4 cores
| 8 GiB
|===

[id="default-requirements-secured-cluster-services-admission-controller_{context}"]
== Admission controller

The Admission controller prevents users from creating workloads that violate policies you configure.

[discrete]
== Memory and CPU requirements

By default, the admission control service runs 3 replicas. The following table lists the request and limits for each replica.

[cols="3",options="header"]
|===
| Admission controller | CPU | Memory

| *Request*
| 0.05 cores
| 100 MiB

| *Limit*
| 0.5 cores
| 500 MiB
|===

[id="default-requirements-secured-cluster-services-collector_{context}"]
== Collector

Collector monitors runtime activity on each node in your secured clusters. It connects to Sensor to report this information. The collector pod has three containers. The first container is collector, which actually monitors and reports the runtime activity on the node. The other two are compliance and node-inventory.

[discrete]
== Collection requirements

To use the `CORE_BPF` collection method, the base kernel must support BTF, and the BTF file must be available to collector.
In general, the kernel version must be later than 5.8 (4.18 for {op-system-base} nodes) and the `CONFIG_DEBUG_INFO_BTF` configuration option must be set.

Collector looks for the BTF file in the standard locations shown in the following list:

.BTF file locations
[%collapsible]
====
[source,terminal]
----
/sys/kernel/btf/vmlinux
/boot/vmlinux-<kernel-version>
/lib/modules/<kernel-version>/vmlinux-<kernel-version>
/lib/modules/<kernel-version>/build/vmlinux
/usr/lib/modules/<kernel-version>/kernel/vmlinux
/usr/lib/debug/boot/vmlinux-<kernel-version>
/usr/lib/debug/boot/vmlinux-<kernel-version>.debug
/usr/lib/debug/lib/modules/<kernel-version>/vmlinux
----
====

If any of these files exists, it is likely that the kernel has BTF support and `CORE_BPF` is configurable.

[discrete]
== Memory and CPU requirements

By default, the admission control service runs 3 replicas. The following table lists the request and limits for each replica.

[cols="4",options="header"]
|===
| Collector |  | CPU | Memory

.2+| *Collector Container*
| *Request*
| 0.06 cores
| 320 MiB

| *Limit*
| 0.9 cores
| 1000 MiB

.2+| *Compliance Container*
| *Request*
| 0.01 cores
| 10 MiB

| *Limit*
| 1 core
| 2000 MiB

.2+| *Node-Inventory Container*
| *Request*
| 0.01 cores
| 10 MiB

| *Limit*
| 1 core
| 500 MiB

.2+| *Total*
| *Request*
| 0.07 cores
| 340 MiB

| *Limit*
| 2.75 cores
| 5000 MiB
|===

== Scanner

#need to add text about Scanner-slim here?#

=== Scanner V4 (optional)

If Scanner V4 is installed on secured clusters, the following requirements apply:

[cols="3",options="header"]
|===
| Scanner V4 Indexer | CPU | Memory
| *Request*
| 1 core
| 1500 MiB
| *Limit*
| 2 cores
| 3000 MiB
|===

Scanner V4 requires Scanner V4 DB to store data. The following table lists the minimum memory and storage values required to install and run Scanner V4 DB. For Scanner V4 DB, a PVC ensures optimal performance and should be 10000 MiB. #is this correct or do we want to say that a PVC is actually required?#

[cols="3",options="header"]

|===
| Scanner V4 DB | CPU | Memory
| *Request*
| .2 cores
| 2000 MiB
| *Limit*
| 2 cores
| 4000 MiB
|===
