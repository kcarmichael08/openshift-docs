:_content-type: ASSEMBLY
[id="examine-images-for-vulnerabilities"]
= Examining images for vulnerabilities
include::modules/common-attributes.adoc[]
:context: examine-images-for-vulnerabilities

toc::[]

[role="_abstract"]
With {product-title} you can analyze images for vulnerabilities.
Scanner analyzes all image layers to check for known vulnerabilities by comparing them with the Common Vulnerabilities and Exposures (CVEs) list.

When Scanner finds any vulnerabilities, it:

* Shows them in the xref:../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management[*Vulnerability Management*] view for detailed analysis.
* Ranks vulnerabilities according to risk and highlights them in the RHACS portal for risk assessment.
* Checks them against enabled xref:../operating/manage-security-policies.adoc#manage-security-policies[security policies].

Scanner inspects the images and identifies the installed components based on the files in the images.
It may fail to identify installed components or vulnerabilities if the final images are modified to remove the following files:

[cols=",a"options="header"]
|===
|Components |Files

|Package managers
|
* `/etc/alpine-release`
* `/etc/apt/sources.list`
* `/etc/lsb-release`
* `/etc/os-release` or `/usr/lib/os-release`
* `/etc/oracle-release`, `/etc/centos-release`, `/etc/redhat-release`, or `/etc/system-release`
* Other similar system files.

|Language-level dependencies
|
* `package.json` for JavaScript.
* `dist-info` or `egg-info` for Python.
* `MANIFEST.MF` in Java Archive (JAR) for Java.

|Application-level dependencies
|
* `dotnet/shared/Microsoft.AspNetCore.App/`
* `dotnet/shared/Microsoft.NETCore.App/`

|===

include::modules/scanning-images.adoc[leveloffset=+1]

include::modules/accessing-delegated-image-scanning.adoc[leveloffset=+1]

include::modules/enhancing-image-scanning-by-accessing-delegated-image-scanning.adoc[leveloffset=+2]

include::modules/configuring-delegated-image-scanning.adoc[leveloffset=+2]

[id="installing-and-configuring-scanning-on-secured-clusters_{context}"]
=== Installing and configuring scanning on secured clusters

[id="using-the-operator_{context}"]
==== Using the Operator

{product-title-short} Operator installs a Scanner-slim version on each secured cluster to scan images in the {ocp} integrated registry and optionally other registries.

For more information, see xref:../installing/installing_ocp/install-secured-cluster-ocp.adoc#installing-sc-operator[Installing {product-title-short} on secured clusters by using the Operator].


[id="using-helm_{context}"]
==== Using Helm

Secured Cluster Services Helm chart (`secured-cluster-services`) installs a Scanner-slim version on each secured cluster.
In Kubernetes, the secured cluster services include Scanner-slim as an optional component.
On {ocp}, however, {product-title-short} installs a Scanner-slim version on each secured cluster to scan images in the {ocp} integrated registry and optionally other registries.

* For {ocp} installations, see xref:../installing/installing_ocp/install-secured-cluster-ocp.adoc#installing-secured-cluster-services-quickly_install-secured-cluster-ocp[Installing the secured-cluster-services Helm chart without customization].

* For non-{ocp} installations, such as Amazon Elastic Kubernetes Service (Amazon EKS), Google Kubernetes Engine (Google GKE), and Microsoft Azure Kubernetes Service (Microsoft AKS), see xref:../installing/installing_other/install-secured-cluster-other.adoc#installing-secured-cluster-services-quickly_install-secured-cluster-other[Installing the secured-cluster-services Helm chart without customization].


[id="verifying-after-installation_{context}"]
==== Verifying after installation

.Procedure

* Verify that the status of the secured cluster indicates that Scanner is present and healthy:
.. In the {product-title-short} portal, navigate to *Platform Configuration -> Clusters*.
.. In the *Clusters* view, select a cluster to view its details.
.. In the *Health Status* card, ensure that *Scanner* is present and is marked as *Healthy.*

include::modules/periodic-scanning-of-images.adoc[leveloffset=+1]

include::modules/scan-inactive-images.adoc[leveloffset=+1]

include::modules/fetching-vulnerability-definitions.adoc[leveloffset=+1]

include::modules/understanding-vulnerability-scores.adoc[leveloffset=+1]

[role="_additional-resources"]
=== Additional resources
* xref:../operating/examine-images-for-vulnerabilities.adoc#scan-inactive-images_examine-images-for-vulnerabilities[Scanning inactive images]
* xref:../cli/installing-the-roxctl-cli.adoc#installing-the-roxctl-cli[Installing the roxctl CLI]
//Add link to integrate image scanners topic

include::modules/view-images-in-your-environment.adoc[leveloffset=+1]

[role="_additional-resources"]
=== Additional resources
* xref:../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management20-view-workload-cve_acs-operating-manage-vulnerabilities[Viewing workload CVEs in Vulnerability Management (2.0)]

include::modules/view-dockerfile-for-image.adoc[leveloffset=+1]

[role="_additional-resources"]
=== Additional resources
* xref:../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management20-view-workload-cve_acs-operating-manage-vulnerabilities[Viewing workload CVEs in Vulnerability Management (2.0)]

include::modules/identify-container-image-layer-that-introduces-vulnerabilities.adoc[leveloffset=+1]

[role="_additional-resources"]
=== Additional resources
* xref:../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management20-view-workload-cve_acs-operating-manage-vulnerabilities[Viewing workload CVEs in Vulnerability Management (2.0)]

include::modules/identify-dockerfile-line-component-cve.adoc[leveloffset=+1]

[role="_additional-resources"]
=== Additional resources
* xref:../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management20-view-workload-cve_acs-operating-manage-vulnerabilities[Viewing workload CVEs in Vulnerability Management (2.0)]

include::modules/identify-operating-system-of-the-base-image.adoc[leveloffset=+1]

[role="_additional-resources"]
=== Additional resources
* xref:../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management20-view-workload-cve_acs-operating-manage-vulnerabilities[Viewing workload CVEs in Vulnerability Management (2.0)]

include::modules/disable-language-specific-vulnerability-scanning.adoc[leveloffset=+1]

[id="additional-resources_examine-images-for-vulnerabilities"]
[role="_additional-resources"]
== Additional resources
* For more information about Common Vulnerabilities and Exposures (CVEs), see the link:https://access.redhat.com/security/cve[Red Hat CVE Database].