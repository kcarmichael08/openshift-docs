:_mod-docs-content-type: ASSEMBLY
[id="examine-images-for-vulnerabilities"]
= Examining images for vulnerabilities
include::modules/common-attributes.adoc[]
:context: examine-images-for-vulnerabilities

toc::[]

[role="_abstract"]
With {product-title} you can analyze images for vulnerabilities using the default {product-title-short} scanner, or you can xref:../integration/integrate-with-image-vulnerability-scanners.adoc#integrate-with-image-vulnerability-scanners[configure an integration] to use another supported scanner. The {product-title-short} scanner analyzes all image layers to check for known Common Vulnerabilities and Exposures (CVEs) by comparing them with a vulnerability database populated from sources that include the National Vulnerability Database (NVD), the Open Source Vulnerabilities (OSV) vulnerability database, and operating system OVAL feeds.
+
[NOTE]
====
The {product-title-short} Scanner V4 uses the OSV database available at OSV.dev under license.
====

{product-title-short} contains two scanners: the StackRox Scanner and Scanner V4. The StackRox Scanner was the default scanner in {product-title-short} before the Scanner V4 was introduced in release 4.4. The StackRox Scanner originates from a fork of the Clair v2 open source scanner. You must continue using this scanner for RHCOS node scanning and for active vulnerability management until that functionality is supported using Scanner v4 in a future release.

[NOTE]
====
This document uses the term "{product-title-short} scanner" to refer to the combined scanning capabilities provided by the two scanners: the StackRox Scanner and Scanner V4. When referring to the capabilities of a specific scanner, the name of the specific scanner is used.
====

When the {product-title-short} scanner finds any vulnerabilities, it performs the following actions:

* Shows them in the xref:../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management[*Vulnerability Management*] view for detailed analysis
* Ranks vulnerabilities according to risk and highlights them in the {product-title-short} portal for risk assessment
* Checks them against enabled xref:../operating/manage-security-policies.adoc#manage-security-policies[security policies]

The {product-title-short} scanner inspects the images and identifies the installed components based on the files in the images.
//verify the following guidance still applies
#Does this still apply to Scanner V4 also?#
It may fail to identify installed components or vulnerabilities if the final images are modified to remove the following files:

[cols=",a"options="header"]
|===
|Components |Files

|Package managers
|
* `/etc/alpine-release`
* `/etc/apt/sources.list`
* `/etc/lsb-release`
* `/etc/os-release` or `/usr/lib/os-release`
* `/etc/oracle-release`, `/etc/centos-release`, `/etc/redhat-release`, or `/etc/system-release`
* Other similar system files.

|Language-level dependencies
|
* `package.json` for JavaScript.
* `dist-info` or `egg-info` for Python.
* `MANIFEST.MF` in Java Archive (JAR) for Java.

|Application-level dependencies
|
* `dotnet/shared/Microsoft.AspNetCore.App/`
* `dotnet/shared/Microsoft.NETCore.App/`

|===

include::modules/consolidated-scanner.adoc[leveloffset=+1]

include::modules/scanning-images.adoc[leveloffset=+1]

include::modules/accessing-delegated-image-scanning.adoc[leveloffset=+1]

include::modules/enhancing-image-scanning-by-accessing-delegated-image-scanning.adoc[leveloffset=+2]

include::modules/configuring-delegated-image-scanning.adoc[leveloffset=+2]

[id="installing-and-configuring-scanning-on-secured-clusters_{context}"]
=== Installing and configuring Scanner-slim on secured clusters

[id="using-the-operator_{context}"]
==== Using the Operator

{product-title-short} Operator installs a Scanner-slim version on each secured cluster to scan images in the {ocp} integrated registry and optionally other registries.

For more information, see xref:../installing/installing_ocp/install-secured-cluster-ocp.adoc#installing-sc-operator[Installing {product-title-short} on secured clusters by using the Operator].


[id="using-helm_{context}"]
==== Using Helm

Secured Cluster Services Helm chart (`secured-cluster-services`) installs a Scanner-slim version on each secured cluster.
In Kubernetes, the secured cluster services include Scanner-slim as an optional component.
On {ocp}, however, {product-title-short} installs a Scanner-slim version on each secured cluster to scan images in the {ocp} integrated registry and optionally other registries.

* For {ocp} installations, see xref:../installing/installing_ocp/install-secured-cluster-ocp.adoc#installing-secured-cluster-services-quickly_install-secured-cluster-ocp[Installing the secured-cluster-services Helm chart without customization].

* For non-{ocp} installations, such as Amazon Elastic Kubernetes Service (Amazon EKS), Google Kubernetes Engine (Google GKE), and Microsoft Azure Kubernetes Service (Microsoft AKS), see xref:../installing/installing_other/install-secured-cluster-other.adoc#installing-secured-cluster-services-quickly_install-secured-cluster-other[Installing the secured-cluster-services Helm chart without customization].

[id="verifying-after-installation_{context}"]
==== Verifying after installation

.Procedure

* Verify that the status of the secured cluster indicates that Scanner is present and healthy:
.. In the {product-title-short} portal, navigate to *Platform Configuration -> Clusters*.
.. In the *Clusters* view, select a cluster to view its details.
.. In the *Health Status* card, ensure that *Scanner* is present and is marked as *Healthy.*

[id="using-image-scanning_{context}"]
==== Using image scanning

You can scan images stored in a cluster specific {ocp} integrated image registry by using `roxctl` CLI, Jenkins, and API. You can specify the appropriate cluster in the delegated scanning configuration or use the cluster parameter available in `roxctl` CLI, Jenkins, and API.

For more information about how to scan images by using the `roxctl` CLI, see xref:../cli/image-scanning-by-using-the-roxctl-cli.adoc#image-scanning-by-using-the-roxctl-cli[Image scanning by using the roxctl CLI].

[id="setting-up-scanning_{context}"]
== Setting up scanning

include::modules/periodic-scanning-of-images.adoc[leveloffset=+2]

include::modules/scan-inactive-images.adoc[leveloffset=+2]

[role="_additional-resources"]
=== Additional resources
* xref:../operating/examine-images-for-vulnerabilities.adoc#scan-inactive-images_examine-images-for-vulnerabilities[Scanning inactive images]
* xref:../cli/installing-the-roxctl-cli.adoc#installing-the-roxctl-cli[Installing the roxctl CLI]
//Add link to integrate image scanners topic

[id="about-vulnerabilities_{context}"]
== About vulnerabilities

//Removed a lot of "additional resources" and added link below to the vulnerability management chapter, common vulnerability management tasks

This section describes how {product-title-short} fetches and presents vulnerabilities. For more information on viewing and addressing vulnerabilities, see xref../operating/manage-vulnerabilities/vulnerability-management.adoc#vulnerability-management[Vulnerability management].

include::modules/fetching-vulnerability-definitions.adoc[leveloffset=+2]

include::modules/understanding-vulnerability-scores.adoc[leveloffset=+2]

//moved identify-dockerfile-line-component-cve.adoc to common vulnerability management chapter

include::modules/disable-language-specific-vulnerability-scanning.adoc[leveloffset=+1]

[id="additional-resources_examine-images-for-vulnerabilities"]
[role="_additional-resources"]
== Additional resources
* For more information about Common Vulnerabilities and Exposures (CVEs), see the link:https://access.redhat.com/security/cve[Red Hat CVE Database].