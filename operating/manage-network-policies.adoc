[id="manage-network-policies"]
= Managing network policies
include::modules/common-attributes.adoc[]
:context: manage-network-policies

toc::[]

[role="_abstract"]
A https://kubernetes.io/docs/concepts/services-networking/network-policies/[Kubernetes network policy] is a specification of how groups of pods are allowed to communicate with each other and other network endpoints.
These network policies are configured as YAML files.
By looking at these files alone, it is often hard to identify whether the applied network policies achieve the desired network topology.

{product-title} gathers all defined network policies from your orchestrator and provides functionality to make these policies easier to use.

To support network policy enforcement, {product-title} provides:

* Network graph
* Network policy simulator
* Network policy generator
* Build-time network policy generator

include::modules/network-graph-view.adoc[leveloffset=+1]

[role="_additional-resources"]
.Additional resources
* xref:../configuration/enable-offline-mode.adoc#update-kernel-support-packages_enable-offline-mode[Updating kernel support packages in offline mode]

include::modules/view-network-policies.adoc[leveloffset=+2]

include::modules/configure-cidr-blocks.adoc[leveloffset=+2]

include::modules/simulate-network-policies.adoc[leveloffset=+1]

include::modules/generate-network-policies.adoc[leveloffset=+1]

include::modules/save-generated-policies.adoc[leveloffset=+2]

include::modules/test-generated-policies.adoc[leveloffset=+2]

include::modules/apply-generated-policies.adoc[leveloffset=+2]

include::modules/delete-generated-policies.adoc[leveloffset=+2]

include::modules/delete-all-autogenerated-policies.adoc[leveloffset=+2]

include::modules/policy-generation-strategy.adoc[leveloffset=+2]

== Using build-time network policy generator
:FeatureName: Build-time network policy generation
include::snippets/technology-preview.adoc[]

The build-time network policy generator can automatically generate Kubernetes network policies based on application YAML manifests. You can use it to develop network policies as part of the CI/CD pipeline before deploying applications on your cluster.

Red Hat developed this feature in partnership with the developers of the link:https://np-guard.github.io/[NP-Guard project].
First, the build-time network policy generator analyzes Kubernetes manifests in a local folder, including service manifests, config maps, and workload manifests such as `Pod`, `Deployment`, `ReplicaSet`, `Job`, `DaemonSet`, and `StatefulSet`.
Then, it discovers the required connectivity and creates the Kubernetes network policies to achieve pod isolation.
These policies allow no more and no less than the needed ingress and egress traffic.

include::modules/generate-build-time-network-policies.adoc[leveloffset=+2]

After generating the policies, you must inspect them for completeness and accuracy, in case any relevant network address was not specified as expected in the YAML files.
Most importantly, verify that required connections are not blocked by the isolating policies. To help with this inspection, you can use {product-title-short} to  simulate the generated network policies .

[NOTE]
====
Red Hat recommends applying network policies to the cluster as part of the workload deployment using automation.
You can follow a GitOps approach by submitting the generated policies using Pull Requests, providing the team an opportunity to review the policies before deploying them as part of the pipeline.
====

include::modules/use-network-baselining.adoc[leveloffset=+1]

include::modules/view-network-baselines.adoc[leveloffset=+2]

include::modules/enable-alert-on-baseline-violations.adoc[leveloffset=+2]
